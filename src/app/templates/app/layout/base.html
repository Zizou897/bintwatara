{% load static %}
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>{{page.title}}</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="" name="keywords" />
    <meta content="" name="description" />

    <!-- Favicon -->
    <link href="{% static 'app/img/favicon.ico'%}" rel="icon" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Poppins:wght@600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="{% static 'app/lib/animate/animate.min.css' %}" rel="stylesheet" />
    <link href="{% static 'app/lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'app/css/bootstrap.min.css' %}" rel="stylesheet" />

    <!-- Template Stylesheet -->
    <link href="{% static 'app/css/style.css' %}" rel="stylesheet" />
  </head>

  <body>
    <!-- Spinner Start -->
    <div
      id="spinner"
      class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center"
    >
      <div class="spinner-grow text-primary" role="status"></div>
    </div>
    <!-- Spinner End -->

    <!-- Topbar Start -->
    <div class="container-fluid bg-light p-0">
      <div class="row gx-0 d-none d-lg-flex">
        <div class="col-lg-7 px-5 text-start">
          <div
            class="h-100 d-inline-flex align-items-center border-start-1 border-end px-3"
          >
            <small class="fa fa-phone-alt me-2"></small>
            <small>{{get_infos_web.phone}}</small>
          </div>
          <div class="h-100 d-inline-flex align-items-center border-end px-3">
            <small class="far fa-envelope-open me-2"></small>
            <small>{{get_infos_web.email}}</small>
          </div>
          <div class="h-100 d-inline-flex align-items-center border-end px-3">
            <small class="far fa-clock me-2"></small>
            <small>{{get_infos_web.opening}}</small>
          </div>
        </div>
        <div class="col-lg-5 px-5 text-end">
          <div class="h-100 d-inline-flex align-items-center">
            {% for social in get_sociaux %}
            <a class="btn btn-square border-end {% if forloop.counter0 %}  {% else %}border-start-1{% endif %}" href="{{social.link}}">
              <i class="{{social.icon}}"></i>
            </a>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    <!-- Topbar End -->

    <!-- Navbar Start -->
    <nav
      class="navbar navbar-expand-lg bg-white navbar-light sticky-top px-4 px-lg-5 py-lg-0"
    >
      <a href="{% url 'welcome' %}" class="navbar-brand d-flex align-items-center">
        <h1 class="m-0">
          <i class="fa fa-building me-3" style="color: #7B3F00"></i>{{get_infos_web.name}}
        </h1>
      </a>
      <button
        type="button"
        class="navbar-toggler"
        data-bs-toggle="collapse"
        data-bs-target="#navbarCollapse"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto py-3 py-lg-0"> 
          <a href="{% url 'welcome' %}" class="nav-item nav-link {% if is_home %}active{% endif %} ">Accueil</a>
          <a href="{% url 'about' %}" class="nav-item nav-link  {% if is_about %}active{% endif %}">A Propos</a>
          <a href="{% url 'service' %}" class="nav-item nav-link  {% if is_service %}active{% endif %}">Nos Services</a>
          {% comment "" %}
          <div class="nav-item dropdown">
            <a
              href="#"
              class="nav-link dropdown-toggle"
              data-bs-toggle="dropdown"
              >Pages</a
            >
            <div class="dropdown-menu bg-light m-0">
              <a href="feature.html" class="dropdown-item">Features</a>
              <a href="appointment.html" class="dropdown-item">Appointment</a>
              <a href="{% url 'team' %}" class="dropdown-item">Our Team</a>
              <a href="testimonial.html" class="dropdown-item">Testimonial</a>
              <a href="404.html" class="dropdown-item">404 Page</a>
            </div>
          </div>
          {% endcomment %}
          <a href="{% url 'contact' %}" class="nav-item nav-link {% if is_contact %}active{% endif %}">Contact</a>
        </div>
      </div>
    </nav>
    <!-- Navbar End -->

    {% block content %}
    {% endblock content %}

   <!-- Footer Start -->
   <div
   class="container-fluid bg-dark footer mt-5 pt-5 wow fadeIn"
   data-wow-delay="0.1s"
 >
   <div class="container py-5">
     <div class="row g-5">
       <div class="col-lg-3 col-md-6">
         <h1 class="text-white mb-4">
           <i class="fa fa-building me-3" style="color:  #FFE00E "></i>{{get_infos_web.name}}
         </h1>
         <p>
           BINT-WATARA est une entrprise de construction et d'inovation dans le secteur du batiment
         </p>
         <div class="d-flex pt-2">
          {% for social in get_sociaux %}
           <a class="btn btn-square btn-outline-primary me-1 btn-social" href="{{social.link}}"
             ><i class="{{social.icon}}"></i
           ></a>
           
           {% endfor %}
         </div>
       </div>
       <div class="col-lg-3 col-md-6">
         <h4 class="text-light mb-4">Adresse</h4>
         <p>
           <i class="fa fa-map-marker-alt me-3"></i>{{get_infos_web.location}}
         </p>
         <p><i class="fa fa-phone-alt me-3"></i>{{get_infos_web.phone}}</p>
         <p><i class="fa fa-envelope me-3"></i>{{get_infos_web.email}}</p>
       </div>
       <div class="col-lg-3 col-md-6">
         <h4 class="text-light mb-4">Liens Rapide</h4>
         <a class="btn btn-link" href="{% url 'about' %}">A propos</a>
         <a class="btn btn-link" href="{% url 'contact' %}">Contact</a>
         <a class="btn btn-link" href="{% url 'service' %}">Nos Services</a>
         <a class="btn btn-link" href="">Termes & Condition</a>
         <a class="btn btn-link" href="">Support</a>
       </div>
       <div class="col-lg-3 col-md-6">
         <h4 class="text-light mb-4">Newsletter</h4>
         <p>Recevez les dernières nouvelles et mises à jour de BINT-WATARA</p>
         <div class="position-relative mx-auto" style="max-width: 400px">
          <form id="Newsletter" action="" method="post" enctype="multipart/form-data"> {% csrf_token %}
           <input
             class="form-control bg-transparent w-100 py-3 ps-4 pe-5"
             type="email"
             placeholder="votre email"
             v-model="email"
           />
           <button
             type="button"
             class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2"  style=" background-color: #FFE00E; color: black;border-color: #FFE00E"
             @click.prevent='sendEmail'
           >
             s'abonner
           </button>
          </form>
         </div>
       </div>
     </div>
   </div>
   <div class="container-fluid copyright">
     <div class="container">
       <div class="row">
         <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
            <a href="#">{{get_infos_web.name}}</a>, 
         </div>
         <div class="col-md-6 text-center text-md-end">
           <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
           &copy; Tous droits reservés 2022.
         </div>
       </div>
     </div>
   </div>
 </div>
 <!-- Footer End -->

 <!-- Back to Top -->
 <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"
   ><i class="bi bi-arrow-up" style="color: black"></i
 ></a>

 <!-- JavaScript Libraries -->
 <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
 <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
 <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
 <script src="{% static 'app/lib/wow/wow.min.js' %}"></script>
 <script src="{% static 'app/lib/easing/easing.min.js' %}"></script>
 <script src="{% static 'app/lib/waypoints/waypoints.min.js' %}"></script>
 <script src="{% static 'app/lib/owlcarousel/owl.carousel.min.js' %}"></script>

 <!-- Template Javascript -->
 <script src="{% static 'app/js/main.js' %}"></script>

 <script>

  new Vue({
    el: '#Newsletter',
    delimiters: ['${', '}'],
    data: {
      email: '',
    },
    methods: {
      sendEmail(){
        if(this.email == ""){
          Swal.fire({
            icon: 'error',
            title: 'Erreur',
            text: 'veuillez saisir votre email !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else if(! /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(this.email)){
          Swal.fire({
            icon: 'error',
            title: 'E-mail incorrect',
            text: 'veuillez saisir un mail correct !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else{
          let myForm = new FormData();
          myForm.append('email', this.email)
          axios.defaults.xsrfCookieName = 'XSRF-TOKEN'
          axios.defaults.xsrfHeaderName = 'X-XSRF-TOKEN'
          axios.post("{% url 'post_mail' %}", myForm, {})
          .then((response)=>{
            if(response.data.success){
              Swal.fire({
                icon: 'success',
                title: 'Abonnement effectuée',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });

              this.email = "";
            }else{
              Swal.fire({
                icon: 'error',
                title: 'Abonnement effectuée',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });
            }
          })
        }
      }
    },
  }),


  new Vue({
    el:'#rdv',
    delimiters: ['${', '}'],
    data:{
      name: '',
      email: '',
      phone: '',
      service: '',
      message: '',
    },
    methods: {
      getRDV(){
        if(this.name == "" || this.email  == "" || this.phone  == "" || this.service  == "" || this.message  == ""){
          Swal.fire({
            icon: 'error',
            title: 'Erreur',
            text: 'veuillez remplir tous les champs !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else if(! /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(this.email)){
          Swal.fire({
            icon: 'error',
            title: 'Erreur',
            text: 'veuillez saisir un mail correct !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else{
          let myForm = new FormData();
          myForm.append('name', this.name)
          myForm.append('email', this.email)
          myForm.append('phone', this.phone)
          myForm.append('service', this.service)
          myForm.append('message', this.message)

          axios.defaults.xsrfCookieName = 'XSRF-TOKEN'
          axios.defaults.xsrfHeaderName = 'X-XSRF-TOKEN'
          axios.post("{% url 'get_rdv' %}", myForm, {})
          .then((response)=>{
            if(response.data.success){
              Swal.fire({
                icon: 'success',
                title: 'Démande Envoyée',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });
              this.name = "";
              this.email = "";
              this.phone = "";
              this.service = "";
              this.message = "";
            }else{
              Swal.fire({
                icon: 'error',
                title: 'Démande non Envoyée',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });
            }
          })
        }
      }
    }
  }),


  new Vue({
    el:'#myContact',
    delimiters: ['${', '}'],
    data:{
      name: '',
      email: '',
      sujet: '',
      message: '',
    },
    methods: {
      postContact(){
        if(this.name == "" || this.email  == "" || this.sujet  == "" || this.message  == ""){
          Swal.fire({
            icon: 'error',
            title: 'Erreur',
            text: 'veuillez remplir tous les champs !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else if(! /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(this.email)){
          Swal.fire({
            icon: 'error',
            title: 'Erreur',
            text: 'veuillez saisir un mail correct !!!',
            showConfirmButton: false,
            timer: 1500
          })
        }else{
          let myForm = new FormData();
          myForm.append('name', this.name)
          myForm.append('email', this.email)
          myForm.append('service', this.sujet)
          myForm.append('message', this.message)

          axios.defaults.xsrfCookieName = 'XSRF-TOKEN'
          axios.defaults.xsrfHeaderName = 'X-XSRF-TOKEN'
          axios.post("{% url 'postContact' %}", myForm, {})
          .then((response)=>{
            if(response.data.success){
              Swal.fire({
                icon: 'success',
                title: 'Merci !!!',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });
              this.name = '';
              this.email = '';
              this.sujet = '';
              this.message = '';
            }else{
              Swal.fire({
                icon: 'error',
                title: 'Erreur',
                text: response.data.msg ,
                showConfirmButton: false,
                timer: 2000
              });
            }
          })
        }
      }
    }
  })

 </script>
 
</body>
</html>